<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>rCharts and d3pie</title>
    <link rel="stylesheet" href="../libraries/frameworks/minimal/stylesheets/styles.css">
    <link rel="stylesheet" href="../libraries/highlighters/prettify/css/twitter-bootstrap.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
        <link rel=stylesheet href="http://fonts.googleapis.com/css?family=PT+Sans"></link>
<link rel=stylesheet href="../assets/css/app.css"></link>
<link rel=stylesheet href="../assets/css/gh-buttons.css"></link>

    
  </head>
  <body>
    <div class="wrapper">
<header>
  <h1>
    <img src="http://ramnathv.github.io/rCharts/libraries/frameworks/minimal/images/rCharts.png">
  </h1>
  <p></p>
  
  <!-- <img width='150px' src='assets/img/'></img>
  -->
  <p class="view">
    <!-- <a href="http://github.com/timelyportfolio/rChartsExtra">
     View the Project on GitHub <small>timelyportfolio/rChartsExtra</small>
    </a>
    <img width='150px' src='assets/img/'></img>
    -->
  </p>
  <ul class='buttons'>
    <li><a href="https://github.com/timelyportfolio/rChartsExtra/zipball/gh-pages">
      Download <strong>ZIP File</strong>
    </a></li>
    <li><a href="https://github.com/timelyportfolio/rChartsExtra/tarball/gh-pages">
      Download <strong>TAR Ball</strong>
    </a></li>
    <li><a href="http://github.com/timelyportfolio/rChartsExtra">
      Fork On <strong>GitHub</strong></a>
    </li>
  </ul>
    <ol>
    </ol>
  <p><a href='http://rcharts.io'>rCharts</a> is an R package, that helps create, customize and share interactive javascript visualizations from R, using a familiar lattice-like interface. You can install it from <a href='http://ramnathv.github.io/rCharts'>github</a>
  </p>
</header>

      <section>
        <h2>d3Pie + rCharts</h2>
<!-- AddThis Smart Layers BEGIN -->

<!-- Go to http://www.addthis.com/get/smart-layers to customize -->

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4fdfcfd4773d48d3"></script>

<script type="text/javascript">
  addthis.layers({
    'theme' : 'transparent',
    'share' : {
      'position' : 'left',
      'numPreferredServices' : 5
    }   
  });
</script>

<!-- AddThis Smart Layers END -->

<p>The design and visualization world loves to belittle pie charts.  However, there still exists a real demand for pie charts.  Me use a pie chart - oh no, but I was delighted to see the announcement of this very robust d3 pie library <a href="http://d3pie.org"><code>d3pie</code></a>.  It is so beautiful and brilliantly designed that it tempted me to violate my self-imposed ban on pie charts.</p>

<h3>Get a rChart Shell for Our Delicious Pies</h3>

<p>Eventually I would like to build a R <code>refClass</code> for <a href="http://d3pie.org"><code>d3pie</code></a>, but for now I wanted to show how we could use <a href="http://d3pie.org"><code>d3pie</code></a> in R with <a href="http://rcharts.io"><code>rCharts</code></a>.  Most of this should be considered experimental as I work through how best to support the <a href="http://d3pie.org/#docs">numerous options and features</a> of <a href="http://d3pie.org"><code>d3pie</code></a>.</p>

<pre><code class="r">dPie &lt;- rCharts$new()
dPie$setLib(&quot;http://timelyportfolio.github.io/rChartsExtra/d3pie&quot;)
#do once to add assets with slidify
cat(add_lib_assets(dPie$lib,cdn=T))
</code></pre>

<script type='text/javascript' src=http://code.jquery.com/jquery-2.1.1.min.js></script>

<script type='text/javascript' src=http://d3js.org/d3.v3.min.js></script>

<script type='text/javascript' src=http://timelyportfolio.github.io/rChartsExtra/d3pie/js/d3pie.js></script>

<h3>Fill Our Pie | Simple Example</h3>

<p>We have our crust, but I think we want more than just crust.  It is probably best to start simple with our filling.  Let&#39;s fill our pie of the star counts on Ramnath&#39;s most <a href="https://github.com/ramnathv">popular Github repos</a>.</p>

<p><img src="./assets/fig/screenshot_github_stars.png" alt="screenshot_of_stars"></p>

<p>A <code>data.frame</code> will be a good way to represent this data.  <code>d3pie</code> expects a <code>label</code> and <code>value</code>.</p>

<pre><code class="r">starData &lt;- data.frame(
  label = c(&quot;rCharts&quot;,&quot;slidify&quot;,&quot;rMaps&quot;),
  value = c(484,318,137)
)
</code></pre>

<p>Now with our <code>starData</code> in proper format we can build a pie chart.  To keep it simple and understandable, we will just provide a title and data and let <code>d3pie</code> works its magic.</p>

<pre><code class="r">dPie$addParams(
  chartspec = list(
    header = list(
      title = list(
        text = &quot;Star Count of Ramnath Repos&quot;
      )
    )
    ,data = list(
      content = starData
    )
  )
)
dPie$params$dom = knitr:::opts_current$get(&quot;label&quot;)
dPie$print()
</code></pre>

<div id = 'simpleexample' class = 'rChart d3pie'></div>

<script>
function drawsimpleexample(){ 
  var params = {
 "dom": "simpleexample",
"width":    800,
"height":    400,
"chartspec": {
 "header": {
 "title": {
 "text": "Star Count of Ramnath Repos" 
} 
},
"data": {
 "content": {
 "label": [ "rCharts", "slidify", "rMaps" ],
"value": [    484,    318,    137 ] 
} 
} 
},
"id": "simpleexample" 
};
  
  //rCharts defaults to send toJSON as columns
  //instead of the expected records for d3pie
  //do the transform the hard way for now
  function columnsToRecords(data){
    var tempdata;
    //avoid lodash for now
    datakeys = Object.keys(data)
    tempdata = data[datakeys[1]].map(function(d,i){
      var tempobj = {}
      datakeys.forEach(function(key){
        tempobj[key] = data[key][i]
      })
      return tempobj
    })
    return tempdata;
  }
  
  params.chartspec.data.content = columnsToRecords(params.chartspec.data.content);
  
  var pie = new d3pie("#" + params.dom, params.chartspec);
  return pie;
};

var simpleexample = drawsimpleexample();
</script>

<h3>Violate a Design Principle of rCharts</h3>

<p><strong>Please note that these examples use a big hairy nested list which violates the author of rCharts Ramnath&#39;s design principles.</strong>  However, this requires no extra code or refClasses, so these ugly nested lists are a nice way to experiment with d3pie.  In a little bit with our more advanced example, I think you will clearly understand why nested listed are not only ugly but also fairly unworkable.</p>

<h3>Fill Our Pie | Advanced Example</h3>

<p>One complicated way to fill our pie is to recreate the <a href="http://d3pie.org/#generator-start">d3pie example</a> and even get the exact JSON from the example with <code>fromJSON</code>.  This will most likely not be the way a R user would populate the options and data of a d3pie, but seeing this method might help us better understand the rCharts binding.</p>

<pre><code class="r">#clear out our chartspec
dPie$params$chartspec &lt;- NULL
#JSON copied from the d3pie example
dPie$addParams(chartspec = rjson::fromJSON(&#39;{  
&quot;header&quot;: {
  &quot;title&quot;: {
    &quot;text&quot;: &quot;Lots of Programming Languages&quot;,
    &quot;fontSize&quot;: 24,
    &quot;font&quot;: &quot;open sans&quot;
  },
  &quot;subtitle&quot;: {
    &quot;text&quot;: &quot;A full pie chart to show off label collision detection and resolution.&quot;,
    &quot;color&quot;: &quot;#999999&quot;,
    &quot;fontSize&quot;: 12,
    &quot;font&quot;: &quot;open sans&quot;
  },
  &quot;titleSubtitlePadding&quot;: 9
},
&quot;footer&quot;: {
  &quot;color&quot;: &quot;#999999&quot;,
  &quot;fontSize&quot;: 10,
  &quot;font&quot;: &quot;open sans&quot;,
  &quot;location&quot;: &quot;bottom-left&quot;
},
&quot;size&quot;: {
  &quot;canvasWidth&quot;: 590
},
&quot;labels&quot;: {
  &quot;outer&quot;: {
    &quot;pieDistance&quot;: 32
  },
  &quot;inner&quot;: {
    &quot;hideWhenLessThanPercentage&quot;: 3
  },
  &quot;mainLabel&quot;: {
    &quot;fontSize&quot;: 11
  },
  &quot;percentage&quot;: {
    &quot;color&quot;: &quot;#ffffff&quot;,
    &quot;decimalPlaces&quot;: 0
  },
  &quot;value&quot;: {
    &quot;color&quot;: &quot;#adadad&quot;,
    &quot;fontSize&quot;: 11
  },
  &quot;lines&quot;: {
    &quot;enabled&quot;: true
  }
},
&quot;effects&quot;: {
  &quot;pullOutSegmentOnClick&quot;: {
    &quot;effect&quot;: &quot;linear&quot;,
    &quot;speed&quot;: 400,
    &quot;size&quot;: 8
  }
},
&quot;misc&quot;: {
  &quot;gradient&quot;: {
    &quot;enabled&quot;: true,
    &quot;percentage&quot;: 100
  }
}
}&#39;
))
</code></pre>

<h3>Serious Violation of No Nested List Design Principle</h3>

<p>As discussed above, <strong>please note that these examples use a big hairy nested list which violates the author of rCharts Ramnath&#39;s design principles.</strong>  One look at this one, and you will probably quickly understand why Ramnath avoids them.</p>

<pre><code class="r">cat(
  paste0(
    capture.output(
      Hmisc:::list.tree(
        dPie$params$chartspec
        ,maxlen=40
      )
    )
    ,separator=&quot;&lt;br&gt;&quot;
  )
)
</code></pre>

<p>dPie$params$chartspec = list 6 (8136 bytes)<br> .  header = list 3<br> . .  title = list 3<br> . . .  text = character 1= Lots of Programming Languages <br> . . .  fontSize = double 1= 24<br> . . .  font = character 1= open sans <br> . .  subtitle = list 4<br> . . .  text = character 1= A full pie chart to show off label colli <br> . . .  color = character 1= #999999 <br> . . .  fontSize = double 1= 12<br> . . .  font = character 1= open sans <br> . .  titleSubtitlePadding = double 1= 9<br> .  footer = list 4<br> . .  color = character 1= #999999 <br> . .  fontSize = double 1= 10<br> . .  font = character 1= open sans <br> . .  location = character 1= bottom-left <br> .  size = list 1<br> . .  canvasWidth = double 1= 590<br> .  labels = list 6<br> . .  outer = list 1<br> . . .  pieDistance = double 1= 32<br> . .  inner = list 1<br> . . .  hideWhenLessThanPercentage = double 1= 3<br> . .  mainLabel = list 1<br> . . .  fontSize = double 1= 11<br> . .  percentage = list 2<br> . . .  color = character 1= #ffffff <br> . . .  decimalPlaces = double 1= 0<br> . .  value = list 2<br> . . .  color = character 1= #adadad <br> . . .  fontSize = double 1= 11<br> . .  lines = list 1<br> . . .  enabled = logical 1= TRUE<br> .  effects = list 1<br> . .  pullOutSegmentOnClick = list 3<br> . . .  effect = character 1= linear <br> . . .  speed = double 1= 400<br> . . .  size = double 1= 8<br> .  misc = list 1<br> . .  gradient = list 2<br> . . .  enabled = logical 1= TRUE<br> . . .  percentage = double 1= 100<br></p>

<h3>Just a List | Change the Title</h3>

<p>One of the nice features of d3pie is the ability to provide a title and subtitle in the chart spec.  To highlight this feature and also prove that we are just working with R <code>lists</code>, let&#39;s change the title.</p>

<pre><code class="r">#as a simple example let&#39;s change the header title
dPie$params$chartspec$header$title = list(
  text = &quot;d3Pie Example Recreated in R with rCharts&quot;,
  fontsize = 20,
  font = &quot;open sans&quot;
)
cat(
  paste0(
    capture.output(
      Hmisc:::list.tree(
        dPie$params$chartspec$header$title
        ,maxlen=40
      )
    )
    ,separator=&quot;&lt;br&gt;&quot;
  )
)
</code></pre>

<p>dPie$params$chartspec$header$title = list 3 (696 bytes)<br> .  text = character 1= d3Pie Example Recreated in R with rChart <br> .  fontsize = double 1= 20<br> .  font = character 1= open sans <br></p>

<h3>JSON -&gt; List -&gt; data.frame</h3>

<p>We now need to get the data from the example.  I am guessing that this is the best test of your R skills.  The simple explanation of the process is</p>

<ul>
<li>get the JSON array of objects <code>[{},{},...]</code> as a R list</li>
<li>make each list item a data.frame</li>
<li>then combine all the data.frame rows into one data.frame.</li>
</ul>

<pre><code class="r">#make the data content list a data.frame and try it out
#data.frame will be the most likely data source
#use rCharts to_json to convert data.frame into expected d3pie format
#if desired and probable in future, build a refClass for d3pie
#to_json(dPie$params$chartspec$data$content,orient=&quot;records&quot;)
data &lt;- do.call(
  rbind,
  lapply(
    rjson::fromJSON(&#39;[
{
  &quot;label&quot;: &quot;JavaScript&quot;,
  &quot;value&quot;: 264131,
  &quot;color&quot;: &quot;#2484c1&quot;
},
{
  &quot;label&quot;: &quot;Ruby&quot;,
  &quot;value&quot;: 218812,
  &quot;color&quot;: &quot;#0c6197&quot;
},
{
  &quot;label&quot;: &quot;Java&quot;,
  &quot;value&quot;: 157618,
  &quot;color&quot;: &quot;#4daa4b&quot;
},
{
  &quot;label&quot;: &quot;PHP&quot;,
  &quot;value&quot;: 114384,
  &quot;color&quot;: &quot;#90c469&quot;
},
{
  &quot;label&quot;: &quot;Python&quot;,
  &quot;value&quot;: 95002,
  &quot;color&quot;: &quot;#daca61&quot;
},
{
  &quot;label&quot;: &quot;C+&quot;,
  &quot;value&quot;: 78327,
  &quot;color&quot;: &quot;#e4a14b&quot;
},
{
  &quot;label&quot;: &quot;C&quot;,
  &quot;value&quot;: 67706,
  &quot;color&quot;: &quot;#e98125&quot;
},
{
  &quot;label&quot;: &quot;Objective-C&quot;,
  &quot;value&quot;: 36344,
  &quot;color&quot;: &quot;#cb2121&quot;
},
{
  &quot;label&quot;: &quot;Shell&quot;,
  &quot;value&quot;: 28561,
  &quot;color&quot;: &quot;#830909&quot;
},
{
  &quot;label&quot;: &quot;Cobol&quot;,
  &quot;value&quot;: 24131,
  &quot;color&quot;: &quot;#923e99&quot;
},
{
  &quot;label&quot;: &quot;C#&quot;,
  &quot;value&quot;: 100,
  &quot;color&quot;: &quot;#ae83d5&quot;
},
{
  &quot;label&quot;: &quot;Coldfusion&quot;,
  &quot;value&quot;: 68,
  &quot;color&quot;: &quot;#bf273e&quot;
},
{
  &quot;label&quot;: &quot;Fortran&quot;,
  &quot;value&quot;: 218812,
  &quot;color&quot;: &quot;#ce2aeb&quot;
},
{
  &quot;label&quot;: &quot;Coffeescript&quot;,
  &quot;value&quot;: 157618,
  &quot;color&quot;: &quot;#bca44a&quot;
},
{
  &quot;label&quot;: &quot;Node&quot;,
  &quot;value&quot;: 114384,
  &quot;color&quot;: &quot;#618d1b&quot;
},
{
  &quot;label&quot;: &quot;Basic&quot;,
  &quot;value&quot;: 95002,
  &quot;color&quot;: &quot;#1ee67b&quot;
},
{
  &quot;label&quot;: &quot;Cola&quot;,
  &quot;value&quot;: 36344,
  &quot;color&quot;: &quot;#b0ec44&quot;
},
{
  &quot;label&quot;: &quot;Perl&quot;,
  &quot;value&quot;: 32170,
  &quot;color&quot;: &quot;#a4a0c9&quot;
},
{
  &quot;label&quot;: &quot;Dart&quot;,
  &quot;value&quot;: 28561,
  &quot;color&quot;: &quot;#322849&quot;
},
{
  &quot;label&quot;: &quot;Go&quot;,
  &quot;value&quot;: 264131,
  &quot;color&quot;: &quot;#86f71a&quot;
},
{
  &quot;label&quot;: &quot;Groovy&quot;,
  &quot;value&quot;: 218812,
  &quot;color&quot;: &quot;#d1c87f&quot;
},
{
  &quot;label&quot;: &quot;Processing&quot;,
  &quot;value&quot;: 157618,
  &quot;color&quot;: &quot;#7d9058&quot;
},
{
  &quot;label&quot;: &quot;Smalltalk&quot;,
  &quot;value&quot;: 114384,
  &quot;color&quot;: &quot;#44b9b0&quot;
},
{
  &quot;label&quot;: &quot;Scala&quot;,
  &quot;value&quot;: 95002,
  &quot;color&quot;: &quot;#7c37c0&quot;
},
{
  &quot;label&quot;: &quot;Visual Basic&quot;,
  &quot;value&quot;: 78327,
  &quot;color&quot;: &quot;#cc9fb1&quot;
},
{
  &quot;label&quot;: &quot;Scheme&quot;,
  &quot;value&quot;: 67706,
  &quot;color&quot;: &quot;#e65414&quot;
},
{
  &quot;label&quot;: &quot;Rust&quot;,
  &quot;value&quot;: 36344,
  &quot;color&quot;: &quot;#8b6834&quot;
},
{
  &quot;label&quot;: &quot;FoxPro&quot;,
  &quot;value&quot;: 32170,
  &quot;color&quot;: &quot;#248838&quot;
}
]&#39;),
    data.frame
  )
)
</code></pre>

<p>Finish our re-creation of the example by supplying our data to our pie.</p>

<pre><code class="r">#now that we have data as a data.frame which a R user should know well
#show how to specify a data.frame as our data.source
dPie$addParams(chartspec = list(
  data = list(
    sortOrder = &quot;value-desc&quot;,
    content = data
  )
))
dPie$params$dom = knitr:::opts_current$get(&quot;label&quot;)
dPie$print()
</code></pre>

<div id = 'example1' class = 'rChart d3pie'></div>

<script>
function drawexample1(){ 
  var params = {
 "dom": "example1",
"width":    800,
"height":    400,
"id": "example1",
"chartspec": {
 "header": {
 "title": {
 "text": "d3Pie Example Recreated in R with rCharts",
"fontsize":     20,
"font": "open sans" 
},
"subtitle": {
 "text": "A full pie chart to show off label collision detection and resolution.",
"color": "#999999",
"fontSize":     12,
"font": "open sans" 
},
"titleSubtitlePadding":      9 
},
"footer": {
 "color": "#999999",
"fontSize":     10,
"font": "open sans",
"location": "bottom-left" 
},
"size": {
 "canvasWidth":    590 
},
"labels": {
 "outer": {
 "pieDistance":     32 
},
"inner": {
 "hideWhenLessThanPercentage":      3 
},
"mainLabel": {
 "fontSize":     11 
},
"percentage": {
 "color": "#ffffff",
"decimalPlaces":      0 
},
"value": {
 "color": "#adadad",
"fontSize":     11 
},
"lines": {
 "enabled": true 
} 
},
"effects": {
 "pullOutSegmentOnClick": {
 "effect": "linear",
"speed":    400,
"size":      8 
} 
},
"misc": {
 "gradient": {
 "enabled": true,
"percentage":    100 
} 
},
"data": {
 "sortOrder": "value-desc",
"content": {
 "label": [ "JavaScript", "Ruby", "Java", "PHP", "Python", "C+", "C", "Objective-C", "Shell", "Cobol", "C#", "Coldfusion", "Fortran", "Coffeescript", "Node", "Basic", "Cola", "Perl", "Dart", "Go", "Groovy", "Processing", "Smalltalk", "Scala", "Visual Basic", "Scheme", "Rust", "FoxPro" ],
"value": [ 2.6413e+05, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  78327,  67706,  36344,  28561,  24131,    100,     68, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  36344,  32170,  28561, 2.6413e+05, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  78327,  67706,  36344,  32170 ],
"color": [ "#2484c1", "#0c6197", "#4daa4b", "#90c469", "#daca61", "#e4a14b", "#e98125", "#cb2121", "#830909", "#923e99", "#ae83d5", "#bf273e", "#ce2aeb", "#bca44a", "#618d1b", "#1ee67b", "#b0ec44", "#a4a0c9", "#322849", "#86f71a", "#d1c87f", "#7d9058", "#44b9b0", "#7c37c0", "#cc9fb1", "#e65414", "#8b6834", "#248838" ] 
} 
} 
} 
};
  
  //rCharts defaults to send toJSON as columns
  //instead of the expected records for d3pie
  //do the transform the hard way for now
  function columnsToRecords(data){
    var tempdata;
    //avoid lodash for now
    datakeys = Object.keys(data)
    tempdata = data[datakeys[1]].map(function(d,i){
      var tempobj = {}
      datakeys.forEach(function(key){
        tempobj[key] = data[key][i]
      })
      return tempobj
    })
    return tempdata;
  }
  
  params.chartspec.data.content = columnsToRecords(params.chartspec.data.content);
  
  var pie = new d3pie("#" + params.dom, params.chartspec);
  return pie;
};

var example1 = drawexample1();
</script>

<h3>Great Defaults of d3Pie</h3>

<p>I want to stress once again how powerful and well-designed <code>d3pie</code> is.  It offers great defaults, solid feautures and behaviors, and easy customization.  Let&#39;s delete the <code>color</code> from our data to see the standard set of <code>d3pie</code> colors.</p>

<pre><code class="r">#now show how d3Pie responds if no color
#hard to tell but the colors are different
dPie$params$chartspec$data &lt;- list(
    sortOrder = &quot;value-desc&quot;,
    content = data[,-3]  #-3 means exclude the color column
)

dPie$params$dom = knitr:::opts_current$get(&quot;label&quot;)
dPie$print()
</code></pre>

<div id = 'example2' class = 'rChart d3pie'></div>

<script>
function drawexample2(){ 
  var params = {
 "dom": "example2",
"width":    800,
"height":    400,
"id": "example2",
"chartspec": {
 "header": {
 "title": {
 "text": "d3Pie Example Recreated in R with rCharts",
"fontsize":     20,
"font": "open sans" 
},
"subtitle": {
 "text": "A full pie chart to show off label collision detection and resolution.",
"color": "#999999",
"fontSize":     12,
"font": "open sans" 
},
"titleSubtitlePadding":      9 
},
"footer": {
 "color": "#999999",
"fontSize":     10,
"font": "open sans",
"location": "bottom-left" 
},
"size": {
 "canvasWidth":    590 
},
"labels": {
 "outer": {
 "pieDistance":     32 
},
"inner": {
 "hideWhenLessThanPercentage":      3 
},
"mainLabel": {
 "fontSize":     11 
},
"percentage": {
 "color": "#ffffff",
"decimalPlaces":      0 
},
"value": {
 "color": "#adadad",
"fontSize":     11 
},
"lines": {
 "enabled": true 
} 
},
"effects": {
 "pullOutSegmentOnClick": {
 "effect": "linear",
"speed":    400,
"size":      8 
} 
},
"misc": {
 "gradient": {
 "enabled": true,
"percentage":    100 
} 
},
"data": {
 "sortOrder": "value-desc",
"content": {
 "label": [ "JavaScript", "Ruby", "Java", "PHP", "Python", "C+", "C", "Objective-C", "Shell", "Cobol", "C#", "Coldfusion", "Fortran", "Coffeescript", "Node", "Basic", "Cola", "Perl", "Dart", "Go", "Groovy", "Processing", "Smalltalk", "Scala", "Visual Basic", "Scheme", "Rust", "FoxPro" ],
"value": [ 2.6413e+05, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  78327,  67706,  36344,  28561,  24131,    100,     68, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  36344,  32170,  28561, 2.6413e+05, 2.1881e+05, 1.5762e+05, 1.1438e+05,  95002,  78327,  67706,  36344,  32170 ] 
} 
} 
} 
};
  
  //rCharts defaults to send toJSON as columns
  //instead of the expected records for d3pie
  //do the transform the hard way for now
  function columnsToRecords(data){
    var tempdata;
    //avoid lodash for now
    datakeys = Object.keys(data)
    tempdata = data[datakeys[1]].map(function(d,i){
      var tempobj = {}
      datakeys.forEach(function(key){
        tempobj[key] = data[key][i]
      })
      return tempobj
    })
    return tempdata;
  }
  
  params.chartspec.data.content = columnsToRecords(params.chartspec.data.content);
  
  var pie = new d3pie("#" + params.dom, params.chartspec);
  return pie;
};

var example2 = drawexample2();
</script>

<h3>Colors from R</h3>

<p><code>rCharts</code> is designed to cater to the R user and assumes no user knowledge of Javascript.  R has lots of color palettes.  We&#39;ll use R&#39;s <code>topo.json</code> palette to configure our pie chart.</p>

<pre><code class="r">#now change so that the color is calculated in R
#?topo.colors
dPie$params$chartspec$data$content &lt;- data.frame(
    data[order(data$value,decreasing=T),-3],  #data w/o the color column
    color = substr(topo.colors(nrow(data)),0,7) #R topo.colors
)
dPie$params$dom = knitr:::opts_current$get(&quot;label&quot;)
dPie$print()
</code></pre>

<div id = 'example3' class = 'rChart d3pie'></div>

<script>
function drawexample3(){ 
  var params = {
 "dom": "example3",
"width":    800,
"height":    400,
"id": "example3",
"chartspec": {
 "header": {
 "title": {
 "text": "d3Pie Example Recreated in R with rCharts",
"fontsize":     20,
"font": "open sans" 
},
"subtitle": {
 "text": "A full pie chart to show off label collision detection and resolution.",
"color": "#999999",
"fontSize":     12,
"font": "open sans" 
},
"titleSubtitlePadding":      9 
},
"footer": {
 "color": "#999999",
"fontSize":     10,
"font": "open sans",
"location": "bottom-left" 
},
"size": {
 "canvasWidth":    590 
},
"labels": {
 "outer": {
 "pieDistance":     32 
},
"inner": {
 "hideWhenLessThanPercentage":      3 
},
"mainLabel": {
 "fontSize":     11 
},
"percentage": {
 "color": "#ffffff",
"decimalPlaces":      0 
},
"value": {
 "color": "#adadad",
"fontSize":     11 
},
"lines": {
 "enabled": true 
} 
},
"effects": {
 "pullOutSegmentOnClick": {
 "effect": "linear",
"speed":    400,
"size":      8 
} 
},
"misc": {
 "gradient": {
 "enabled": true,
"percentage":    100 
} 
},
"data": {
 "sortOrder": "value-desc",
"content": {
 "label": [ "JavaScript", "Go", "Ruby", "Fortran", "Groovy", "Java", "Coffeescript", "Processing", "PHP", "Node", "Smalltalk", "Python", "Basic", "Scala", "C+", "Visual Basic", "C", "Scheme", "Objective-C", "Cola", "Rust", "Perl", "FoxPro", "Shell", "Dart", "Cobol", "C#", "Coldfusion" ],
"value": [ 2.6413e+05, 2.6413e+05, 2.1881e+05, 2.1881e+05, 2.1881e+05, 1.5762e+05, 1.5762e+05, 1.5762e+05, 1.1438e+05, 1.1438e+05, 1.1438e+05,  95002,  95002,  95002,  78327,  78327,  67706,  67706,  36344,  36344,  36344,  32170,  32170,  28561,  28561,  24131,    100,     68 ],
"color": [ "#4C00FF", "#2A00FF", "#0800FF", "#0019FF", "#003CFF", "#005DFF", "#0080FF", "#00A2FF", "#00C3FF", "#00E5FF", "#00FF4D", "#00FF26", "#00FF00", "#26FF00", "#4DFF00", "#73FF00", "#99FF00", "#BFFF00", "#E6FF00", "#FFFF00", "#FFF316", "#FFEA2D", "#FFE343", "#FFDE59", "#FFDB70", "#FFDB86", "#FFDC9C", "#FFE0B3" ] 
} 
} 
} 
};
  
  //rCharts defaults to send toJSON as columns
  //instead of the expected records for d3pie
  //do the transform the hard way for now
  function columnsToRecords(data){
    var tempdata;
    //avoid lodash for now
    datakeys = Object.keys(data)
    tempdata = data[datakeys[1]].map(function(d,i){
      var tempobj = {}
      datakeys.forEach(function(key){
        tempobj[key] = data[key][i]
      })
      return tempobj
    })
    return tempdata;
  }
  
  params.chartspec.data.content = columnsToRecords(params.chartspec.data.content);
  
  var pie = new d3pie("#" + params.dom, params.chartspec);
  return pie;
};

var example3 = drawexample3();
</script>

<h3>R Sort</h3>

<p>You might notice that the colors don&#39;t look right.  The reason why is that Scala, Smalltalk, and PHP have the same values.  Like with the colors, we can let R do the sorting for us.</p>

<pre><code class="r">#sort from d3pie is slightly different so let R sort
#since values for smalltalk = node = php
dPie$params$chartspec$data$sortOrder &lt;- NULL
dPie$params$dom = knitr:::opts_current$get(&quot;label&quot;)
dPie$print()
</code></pre>

<div id = 'example4' class = 'rChart d3pie'></div>

<script>
function drawexample4(){ 
  var params = {
 "dom": "example4",
"width":    800,
"height":    400,
"id": "example4",
"chartspec": {
 "header": {
 "title": {
 "text": "d3Pie Example Recreated in R with rCharts",
"fontsize":     20,
"font": "open sans" 
},
"subtitle": {
 "text": "A full pie chart to show off label collision detection and resolution.",
"color": "#999999",
"fontSize":     12,
"font": "open sans" 
},
"titleSubtitlePadding":      9 
},
"footer": {
 "color": "#999999",
"fontSize":     10,
"font": "open sans",
"location": "bottom-left" 
},
"size": {
 "canvasWidth":    590 
},
"labels": {
 "outer": {
 "pieDistance":     32 
},
"inner": {
 "hideWhenLessThanPercentage":      3 
},
"mainLabel": {
 "fontSize":     11 
},
"percentage": {
 "color": "#ffffff",
"decimalPlaces":      0 
},
"value": {
 "color": "#adadad",
"fontSize":     11 
},
"lines": {
 "enabled": true 
} 
},
"effects": {
 "pullOutSegmentOnClick": {
 "effect": "linear",
"speed":    400,
"size":      8 
} 
},
"misc": {
 "gradient": {
 "enabled": true,
"percentage":    100 
} 
},
"data": {
 "content": {
 "label": [ "JavaScript", "Go", "Ruby", "Fortran", "Groovy", "Java", "Coffeescript", "Processing", "PHP", "Node", "Smalltalk", "Python", "Basic", "Scala", "C+", "Visual Basic", "C", "Scheme", "Objective-C", "Cola", "Rust", "Perl", "FoxPro", "Shell", "Dart", "Cobol", "C#", "Coldfusion" ],
"value": [ 2.6413e+05, 2.6413e+05, 2.1881e+05, 2.1881e+05, 2.1881e+05, 1.5762e+05, 1.5762e+05, 1.5762e+05, 1.1438e+05, 1.1438e+05, 1.1438e+05,  95002,  95002,  95002,  78327,  78327,  67706,  67706,  36344,  36344,  36344,  32170,  32170,  28561,  28561,  24131,    100,     68 ],
"color": [ "#4C00FF", "#2A00FF", "#0800FF", "#0019FF", "#003CFF", "#005DFF", "#0080FF", "#00A2FF", "#00C3FF", "#00E5FF", "#00FF4D", "#00FF26", "#00FF00", "#26FF00", "#4DFF00", "#73FF00", "#99FF00", "#BFFF00", "#E6FF00", "#FFFF00", "#FFF316", "#FFEA2D", "#FFE343", "#FFDE59", "#FFDB70", "#FFDB86", "#FFDC9C", "#FFE0B3" ] 
} 
} 
} 
};
  
  //rCharts defaults to send toJSON as columns
  //instead of the expected records for d3pie
  //do the transform the hard way for now
  function columnsToRecords(data){
    var tempdata;
    //avoid lodash for now
    datakeys = Object.keys(data)
    tempdata = data[datakeys[1]].map(function(d,i){
      var tempobj = {}
      datakeys.forEach(function(key){
        tempobj[key] = data[key][i]
      })
      return tempobj
    })
    return tempdata;
  }
  
  params.chartspec.data.content = columnsToRecords(params.chartspec.data.content);
  
  var pie = new d3pie("#" + params.dom, params.chartspec);
  return pie;
};

var example4 = drawexample4();
</script>

      </section>
      <footer>
        <p>Maintained by <a href="http://github.com/timelyportfolio">
          TimelyPortfolio
        </a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by 
          <a href="https://github.com/orderedlist">orderedlist</a></small>
        </p>
      </footer>    </div>
    <script src="../libraries/frameworks/minimal/javascripts/scale.fix.js"></script>
  </body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- Google Prettify -->
  <script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <script src='../libraries/highlighters/prettify/js/lang-r.js'></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i=0; i < pres.length; ++i) {
      pres[i].className = "prettyprint linenums";
    }
    prettyPrint();
  </script>
  <!-- End Google Prettify --> 
  </html>